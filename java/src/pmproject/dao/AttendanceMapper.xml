<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
  
<mapper namespace="pmproject.dao.AttendanceDAO">
    <insert id="recordAttendance" parameterType="java.util.Map">
        INSERT INTO attendance (employee_id, status, date_time)
        VALUES (#{employeeId}, '출근', #{dateTime})
    </insert>
    <insert id="recordLeave" parameterType="java.util.Map">
        INSERT INTO attendance (employee_id, status, date_time)
        VALUES (#{employeeId}, '퇴근', #{dateTime})
    </insert>
    <select id="viewAttendance" parameterType="int" resultType="String">
        SELECT status
        FROM attendance
        WHERE employee_id = #{employeeId}
        ORDER BY date_time DESC
        LIMIT 1
    </select>
    <update id="changeAttendance" parameterType="java.util.Map">
        UPDATE attendance
        SET status = #{newStatus}
        WHERE employee_id = #{employeeId}
        ORDER BY date_time DESC
        LIMIT 1
    </update>
    <insert id="applyLeave" parameterType="java.util.Map">
        INSERT INTO leave_request (employee_id, leave_type, start_date, end_date)
        VALUES (#{employeeId}, #{leaveType}, #{startDate}, #{endDate})
    </insert>
    <select id="viewLeave" parameterType="int" resultType="String">
        SELECT leave_status
        FROM leave_request
        WHERE employee_id = #{employeeId}
        ORDER BY request_id DESC
        LIMIT 1
    </select>
</mapper>